# @h6s/calendar 비판적 평가 보고서

> **분석 일자**: 2026-01-12
> **버전**: v2.0.3
> **분석자**: Claude Code (Opus 4.5)

---

## 1. 개요

`@h6s/calendar`는 React 기반의 헤드리스(headless) 캘린더 훅 라이브러리다. UI 렌더링 없이 순수하게 캘린더 로직과 상태 관리만을 제공하는 것이 핵심 철학이다.

### 핵심 통계
| 항목 | 값 |
|------|-----|
| 프로덕션 코드 | ~620 LOC |
| 테스트 코드 | ~975 LOC |
| 핵심 의존성 | date-fns v4.1.0 |
| 빌드 크기 | ~2KB (gzipped 추정) |
| 내보내는 API | 단일 훅 (`useCalendar`) |

---

## 2. 현재 제공하는 기능

### 2.1 뷰 타입
- **월간 뷰 (Month)**: 4~6주 그리드 형태의 월간 달력
- **주간 뷰 (Week)**: 7일 단위의 주간 달력
- **일간 뷰 (Day)**: 단일 날짜 표시

### 2.2 네비게이션
- 이전/다음 (월/주/일) 이동
- 오늘 날짜로 즉시 이동
- 임의 날짜로 점프

### 2.3 설정
- 주 시작 요일 설정 (일요일~토요일)
- 기본 날짜 및 뷰 타입 설정

### 2.4 데이터 구조
- 헤더 (요일 정보)
- 바디 (날짜 그리드 매트릭스)
- 각 셀에 `isCurrentMonth`, `isCurrentDate`, `isWeekend` 등 메타데이터 제공

### 2.5 아키텍처적 강점
- **순수 함수 기반 코어**: 테스트와 유지보수 용이
- **플러그인 패턴**: `withDateProps`, `withKeyProps`로 확장 가능
- **파이프 패턴**: 함수형 프로그래밍 스타일의 데이터 변환

---

## 3. 치명적인 한계점

### 3.1 타임존 미지원 ⚠️ **심각**

**현재 상태**: JavaScript의 `Date` 객체와 `date-fns`의 로컬 타임존에 전적으로 의존한다.

**문제점**:
- 사용자가 타임존이 다른 지역으로 이동하면 날짜가 어긋날 수 있음
- DST(일광절약시간) 전환 시점에서 날짜 계산 오류 가능성
- 글로벌 서비스에서 사용 불가
- 서버 사이드 렌더링 시 서버/클라이언트 타임존 불일치 문제

**영향**: 국제 사용자가 있는 프로덕션 서비스에서는 **사용 불가** 수준의 제약

**개선 방안**:
```typescript
// 제안: 타임존 옵션 추가
useCalendar({
  timezone: 'Asia/Seoul', // 또는 'UTC'
  // ...
})
```

### 3.2 국제화(i18n) 부재 ⚠️ **심각**

**현재 상태**: 어떠한 로케일 지원도 없다. 요일 이름, 월 이름 등 모든 텍스트는 소비자가 직접 포맷해야 한다.

**문제점**:
- 각 국가별 주 시작 요일 컨벤션 미지원 (예: 유럽은 월요일 시작)
- RTL(아랍어, 히브리어) 레이아웃 고려 없음
- 다른 달력 시스템(히브리력, 이슬람력 등) 미지원
- 소비자 측에서 매번 `format()` 호출 필요

**영향**: 다국어 서비스에서 추가 구현 비용 발생

### 3.3 접근성(a11y) 지원 없음 ⚠️ **심각**

**현재 상태**: 헤드리스 라이브러리이므로 렌더링은 소비자 책임이라는 논리로 접근성을 완전히 무시하고 있다.

**문제점**:
- ARIA 속성 생성 헬퍼 없음
- 키보드 네비게이션 핸들러 없음
- 포커스 관리 유틸리티 없음
- 스크린 리더를 위한 가이드라인이나 예제 없음
- 예제 코드조차 접근성 모범 사례 미준수

**비판**: "헤드리스"라는 이유로 접근성을 방치하는 것은 **설계 철학의 결함**이다. 헤드리스 라이브러리도 접근성 유틸리티를 제공할 수 있고, 제공해야 한다.

**개선 방안**:
```typescript
// 제안: 접근성 헬퍼 제공
const { getGridProps, getCellProps, getNavigationProps } = useCalendar({...})

// getCellProps 예시 반환값
{
  role: 'gridcell',
  'aria-label': '2026년 1월 12일 월요일',
  'aria-selected': true,
  tabIndex: 0,
}
```

### 3.4 이벤트/데이터 연동 불가

**현재 상태**: 순수하게 날짜 그리드만 제공하며, 날짜에 데이터를 연결하는 방법이 없다.

**문제점**:
- 일정/이벤트 표시 기능 없음
- 날짜별 데이터 바인딩 패턴 미제공
- 선택(selection) 상태 관리 없음
- 다중 선택, 범위 선택 미지원

**영향**: 실제 캘린더 앱을 만들려면 상당한 추가 구현 필요

---

## 4. 설계상 문제점

### 4.1 과도하게 큰 단일 훅

`useCalendar.ts`가 141줄로, 단일 훅이 너무 많은 책임을 지고 있다:
- 상태 관리 (cursorDate, viewType, weekStartsOn)
- 네비게이션 로직
- 매트릭스 생성
- 플러그인 적용
- 뷰 타입별 분기 처리

**문제점**:
- 일부 기능만 필요해도 전체를 가져와야 함
- 트리 쉐이킹 비효율
- 테스트 복잡도 증가

**개선 방안**: 훅 분리
```typescript
// 분리된 훅 제안
useCalendarNavigation()
useCalendarMatrix()
useCalendarView()
```

### 4.2 SSR 처리의 의문스러운 패턴

```typescript
// 현재 구현
const isMounted = useIsMounted()
if (!isMounted) return null
```

**문제점**:
- 첫 렌더에서 빈 화면/null 반환
- hydration 불일치 가능성
- SEO에 불리함
- 왜 SSR에서 캘린더를 렌더링할 수 없는지 명확하지 않음

### 4.3 ID 생성 방식의 위험성

```typescript
// 현재 구현
let count = 0
export function generateID(prefix: string) {
  return `${prefix}-${count++}`
}
```

**문제점**:
- 글로벌 카운터 사용 → 모듈 간 충돌 가능
- SSR에서 서버/클라이언트 ID 불일치
- 이론적으로 오버플로우 가능 (실용적 문제는 아님)

---

## 5. 테스트 커버리지 분석

### 5.1 양호한 영역
| 영역 | 상태 | 비고 |
|------|------|------|
| 코어 로직 | ✅ 양호 | 날짜 계산 잘 테스트됨 |
| 훅 상태 관리 | ✅ 양호 | 48개 테스트 케이스 |
| 유틸리티 함수 | ✅ 우수 | 모든 유틸 테스트됨 |
| 플러그인 | ✅ 양호 | 두 플러그인 모두 테스트됨 |
| E2E | ✅ 기본 | 렌더링, 네비게이션 테스트 |

### 5.2 부재하는 영역 ⚠️
| 영역 | 상태 | 위험도 |
|------|------|--------|
| 타임존 | ❌ 없음 | 높음 |
| DST 전환 | ❌ 없음 | 높음 |
| 윤년 | ❌ 없음 | 중간 |
| 연도 경계 | ❌ 없음 | 중간 |
| 접근성 | ❌ 없음 | 높음 |
| 성능 벤치마크 | ❌ 없음 | 낮음 |
| 메모리 누수 | ❌ 없음 | 중간 |

### 5.3 테스트 누락 구체 사례

```typescript
// 누락된 테스트 예시

// 1. DST 전환
it('handles DST spring forward correctly', () => {
  // 3월 둘째 일요일 새벽 2시 → 3시
  // 이 날짜에서 날짜 계산이 정확한가?
})

// 2. 윤년
it('handles Feb 29 to Mar 1 transition', () => {
  // 2024년 2월 29일 → 3월 1일 이동 시
})

// 3. 연도 경계
it('navigates from Dec 31 to Jan 1 correctly', () => {
  // 년도 변경 시 모든 상태가 올바른가?
})

// 4. 역사적 날짜
it('handles dates before Unix epoch', () => {
  // 1970년 이전 날짜 처리
})
```

---

## 6. 문서화 평가

### 현재 상태: **불충분**

**README 내용**:
- 기본 설치 방법
- 간단한 사용 예제
- API 간략 설명

**누락된 내용**:
- 아키텍처 설명 없음
- 플러그인 작성 가이드 없음
- 접근성 구현 가이드 없음
- 타임존 주의사항 없음
- 마이그레이션 가이드 없음
- 트러블슈팅 없음
- 고급 사용 사례 없음

**스토리북**: 있으나 단일 예제만 존재

---

## 7. 경쟁 라이브러리 대비 포지셔닝

### 7.1 비교표

| 기능 | @h6s/calendar | react-calendar | react-big-calendar | FullCalendar |
|------|---------------|----------------|-------------------|--------------|
| 번들 크기 | ~2KB | ~30KB | ~50KB | ~100KB+ |
| UI 제공 | ❌ | ✅ | ✅ | ✅ |
| 이벤트 지원 | ❌ | 제한적 | ✅ | ✅ |
| 타임존 | ❌ | ❌ | 제한적 | ✅ |
| i18n | ❌ | ✅ | ✅ | ✅ |
| 접근성 | ❌ | 부분 | 부분 | ✅ |
| 커스터마이징 | 높음 | 중간 | 중간 | 높음 |

### 7.2 포지셔닝 문제

**현재 포지션**: "로직만 제공하는 미니멀 라이브러리"

**문제점**:
1. **너무 미니멀함**: 최소한의 기능만 제공하여 실제 사용 시 많은 추가 구현 필요
2. **니치 시장**: 헤드리스 캘린더 수요 자체가 제한적
3. **대안 존재**: Radix UI, Headless UI 등 더 성숙한 헤드리스 생태계
4. **확장성 부족**: 플러그인 시스템이 있으나 기본 제공 플러그인이 2개뿐

**시장 적합성**:
- 디자인 시스템 구축 팀: ⭐⭐⭐ (적합)
- 일반 앱 개발자: ⭐ (부적합)
- 엔터프라이즈: ⭐ (기능 부족)

---

## 8. 개선 권고사항

### 8.1 필수 개선 (Critical)

1. **타임존 지원 추가**
   - `date-fns-tz` 통합
   - UTC 모드 옵션
   - 타임존 명시 옵션

2. **접근성 헬퍼 제공**
   - ARIA props 생성 함수
   - 키보드 네비게이션 훅
   - 포커스 트랩 유틸리티

3. **날짜 범위 선택 지원**
   - 단일 선택
   - 다중 선택
   - 범위 선택

### 8.2 권장 개선 (Recommended)

4. **국제화 기반 마련**
   - 로케일 옵션
   - 주 시작 요일 자동 설정
   - 날짜 포맷 헬퍼

5. **테스트 강화**
   - DST 테스트 추가
   - 윤년 테스트 추가
   - 연도 경계 테스트
   - 접근성 테스트

6. **문서화 개선**
   - 아키텍처 문서
   - 접근성 구현 가이드
   - 더 많은 예제

### 8.3 고려 사항 (Nice to have)

7. **이벤트 데이터 바인딩**
   - 날짜별 데이터 연결 API
   - 이벤트 렌더링 가이드

8. **훅 분리**
   - 기능별 세분화된 훅
   - 트리 쉐이킹 개선

9. **성능 최적화**
   - 가상화 지원
   - 메모이제이션 개선

---

## 9. 결론

### 점수표

| 항목 | 점수 | 코멘트 |
|------|------|--------|
| 코드 품질 | 8/10 | 깔끔하고 타입 안전함 |
| 아키텍처 | 7/10 | 플러그인 패턴 좋으나 과도한 단일 훅 |
| 테스트 | 6/10 | 기본 커버리지 양호, 엣지 케이스 부족 |
| 기능 완성도 | 4/10 | 최소 기능만 제공 |
| 접근성 | 2/10 | 사실상 없음 |
| 국제화 | 1/10 | 없음 |
| 문서화 | 4/10 | 기본적인 수준 |
| **종합** | **5/10** | |

### 최종 평가

`@h6s/calendar`는 **기술적으로 잘 구현된, 그러나 기능적으로 미완성인 라이브러리**다.

**강점**:
- 깔끔한 코드베이스
- 타입 안전성
- 작은 번들 크기
- 순수 함수 기반 아키텍처

**약점**:
- 프로덕션 사용에 치명적인 기능 누락 (타임존, 접근성)
- 지나치게 미니멀하여 실용성 저하
- 경쟁 라이브러리 대비 차별점 부족
- 문서와 예제 부족

**권고**:
헤드리스 캘린더로서의 정체성을 유지하되, **접근성과 타임존 지원은 반드시 추가**해야 한다. 현재 상태로는 "프로토타입" 또는 "학습용" 수준이며, 프로덕션 서비스에 사용하기에는 리스크가 있다.

헤드리스 라이브러리가 "UI를 제공하지 않는다"는 것과 "필수 기능을 제공하지 않는다"는 것은 다른 문제다. 전자는 철학이고, 후자는 결함이다.

---

## 부록: 파일 구조 참조

```
packages/calendar/src/
├── useCalendar.ts          # 메인 훅 (141 LOC)
├── core/
│   └── createCalendarInfo.ts  # 코어 로직 (56 LOC)
├── plugins/
│   ├── withDateProps.ts    # 날짜 속성 플러그인 (22 LOC)
│   └── withKeyProps.ts     # 키 플러그인 (10 LOC)
├── utils/
│   ├── pipe.ts             # 함수 합성 (147 LOC)
│   ├── isSameDate.ts       # 날짜 비교 (10 LOC)
│   └── ...                 # 기타 유틸리티
├── models/
│   ├── Calendar.ts         # 인터페이스 정의
│   ├── CalendarViewType.ts # 뷰 타입 enum
│   └── WeekDayType.ts      # 요일 타입
└── hooks/
    └── useIsMounted.tsx    # SSR 헬퍼 (11 LOC)
```
